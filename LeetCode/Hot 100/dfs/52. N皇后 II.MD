    int[][] used;                                 //记录[row][col]是否可以使用
    StringBuilder sb = new StringBuilder();
    public int totalNQueens(int n) {
        used = new int[n][n];
        List<String> ans = new ArrayList<String>();
        dfs(0,ans);                               //从0行开始访问，若达到used.length行则返回
        return ans.size();
    }
    
    public  void dfs(int row,List<String> ans){
        if(row==used.length){
            ans.add(sb.toString());
            return ;
        }

        for(int col=0;col<used.length;col++){
            if(used[row][col]!=0){
                continue;
            }
            sb.append(col+1);
            note(row,col);
            dfs(row+1,ans);                       //回溯，访问下一行
            sb.deleteCharAt(sb.length()-1);
            denote(row,col);
        }

    }

    public void note(int row,int col){            //根据row,col标记同行；同列；对角线的元素，记录次数防止不同位置都标记了该位置
        for(int i=0;i<used.length;i++){
            used[row][i]++;
            used[i][col]++;
        }
        used[row][col]--;
        int i = 1;
        while(row+i<used.length||row-i>=0||col+i<used.length||col-i>=0){
            if(row+i<used.length){
                if(col+i<used.length){
                    used[row+i][col+i]++;
                }
                if(col-i>=0){
                    used[row+i][col-i]++;
                }
            }
            if(row-i>=0){
                if(col+i<used.length){
                    used[row-i][col+i]++;
                }
                if(col-i>=0){
                    used[row-i][col-i]++;
                }
            }
            i++;
        }
    }

    public void denote(int row,int col){
        for(int i=0;i<used.length;i++){
            used[row][i]--;
            used[i][col]--;
        }
        used[row][col]++;
        int i=1;
        while(row+i<used.length||row-i>=0||col+i<used.length||col-i>=0){
            if(row+i<used.length){
                if(col+i<used.length){
                    used[row+i][col+i]--;
                }
                if(col-i>=0){
                    used[row+i][col-i]--;
                }
            }
            if(row-i>=0){
                if(col+i<used.length){
                    used[row-i][col+i]--;
                }
                if(col-i>=0){
                    used[row-i][col-i]--;
                }
            }
            i++;
        }
    }
